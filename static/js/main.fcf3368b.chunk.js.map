{"version":3,"sources":["cell.js","logManager.js","dialog.js","settingDialog.js","game.js","dataAnalysis.js","langpack.js","index.js"],"names":["GamePage","handleClick","status","props","data","digged","value","marked","onDig","this","classList","valueDisplay","className","join","onClick","Component","clearLog","localStorage","removeItem","Dialog","container","visible","document","body","removeChild","createElement","add","modalClass","appendChild","customClass","push","ReactDOM","render","children","limitValue","min","max","SettingDialog","state","display","width","height","mines","errorMsg","resolve","reject","handleInputChange","e","target","test","Number","name","MAX_WIDTH","setState","setLevel","level","startGame","errorList","length","maxMines","cancelSubmit","param","Promise","Object","assign","Translation","t","autoComplete","maxLength","onInput","map","VALUE_MINE","board","operation","$refs","settingDialog","createRef","openSetting","a","current","open","setItem","JSON","stringify","console","error","row","array","col","key","Math","random","handleDig","cell","initMines","dig","autoproc","gameFinished","forEach","counter","time","Date","getTime","success","storageData","storageDataRaw","getItem","parse","Array","isArray","item","id","uuid","writeLog","openDataAnalysis","window","rows","cols","row0","col0","result","count","getNeighbours","mineCount","y","x","RangeError","cellList","i","j","floor","temp","iCell","splice","getNeighbourMineCount","further","neighbours","filter","mark","markCount","settingData","statusClass","statusMsg","remainMines","ref","DataAnalysis","confirmDeleteDialog","dataRaw","dataList","exportJSON","saveAs","Blob","type","exportDBF","dbfData","WIDTH","HEIGHT","MINES","SUCCESS","STEPS","START","TIME","dbf","structure","buffer","clearData","cancelDelete","confirmDelete","loadLogData","goBack","close","location","readLog","listLow","listMid","listHigh","label","getStatResult","success_times","one_click_finish","total_steps","time_total","success_rate","average_steps","average_time","toFixed","translation","i18n","use","initReactI18next","LanguageDetector","init","resources","fallbackLng","keySeparator","interpolation","escapeValue","detection","order","lookupQuerystring","caches","then","title","StrictMode","path","exact","component","getElementById"],"mappings":"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","file":"static/js/main.fcf3368b.chunk.js","sourcesContent":["import {Component} from 'react';\r\n\r\nconst VALUE_MINE=9;\r\nexport default class GamePage extends Component{\r\n    handleClick=()=>{\r\n        let status=this.props.status, data=this.props.data,\r\n            digged=data.value&0x80, marked=data.value&0x40;\r\n        if('failed'===status || 'success'===status || digged || marked){\r\n            return;\r\n        }\r\n        this.props.onDig(this.props.data);\r\n    }\r\n    render(){\r\n        let data=this.props.data, value=data.value&0x0f;\r\n        let digged=data.value&0x80, marked=data.value&0x40;\r\n        let classList=[\r\n            'cell',\r\n            digged ? 'digged' : '',\r\n            VALUE_MINE===value ? 'mine' : '',\r\n            marked ? 'marked' : '',\r\n            'failed'===this.props.status || 'success'===this.props.status ? 'inactive' : ''\r\n        ];\r\n        let valueDisplay='';\r\n        if(marked){\r\n            valueDisplay='★';\r\n        }else if(digged){\r\n            switch(value){\r\n                case VALUE_MINE:\r\n                    valueDisplay='雷';\r\n                break;\r\n                case 0:\r\n                    valueDisplay='';\r\n                break;\r\n                default:\r\n                    valueDisplay=value;\r\n                break;\r\n            }\r\n        }else if('failed'===this.props.status && VALUE_MINE===value){\r\n            valueDisplay='雷';\r\n        }\r\n        return (\r\n            <div className={classList.join(' ')} onClick={this.handleClick}>\r\n                {valueDisplay}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import {v4 as uuid} from 'uuid';\r\nimport {VALUE_MINE} from './game.js';\r\n\r\nexport function writeLog(board,operation,success=false){\r\n    let width=board[0].data.length, height=board.length, mines=[];\r\n    for(let row=0; row<height; row++){\r\n        for(let col=0; col<width; col++){\r\n            let value=board[row].data[col].value;\r\n            if(VALUE_MINE===(value&0x0f)){\r\n                mines.push({col,row});\r\n            }\r\n        }\r\n    }\r\n\r\n    let storageData=[];\r\n    try{\r\n        let storageDataRaw=localStorage.getItem('react-minesweeper-log');\r\n        if(storageDataRaw){\r\n            storageData=JSON.parse(storageDataRaw);\r\n        }\r\n    }catch(e){\r\n        console.error(e);\r\n    }\r\n    if(!Array.isArray(storageData)){\r\n        storageData=[];\r\n    }\r\n    for(let item of storageData){\r\n        if(!item.id){\r\n            item.id=uuid();\r\n        }\r\n    }\r\n    storageData.push({\r\n        id:uuid(),\r\n        width,\r\n        height,\r\n        success,\r\n        mines,\r\n        operation\r\n    });\r\n    localStorage.setItem('react-minesweeper-log',JSON.stringify(storageData));\r\n}\r\nexport function readLog(){\r\n    let storageData=[];\r\n    try{\r\n        let storageDataRaw=localStorage.getItem('react-minesweeper-log');\r\n        if(storageDataRaw){\r\n            storageData=JSON.parse(storageDataRaw);\r\n        }\r\n    }catch(e){\r\n        console.error(e);\r\n    }\r\n    return storageData;\r\n}\r\nexport function clearLog(){\r\n    localStorage.removeItem('react-minesweeper-log');\r\n}\r\n","import {Component} from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nexport default class Dialog extends Component{\r\n  container=null;\r\n  constructor(){\r\n    super();\r\n  }\r\n  componentDidUpdate(){\r\n    let visible=this.props.visible;\r\n    //切换body上的容器的新建和销毁\r\n    if(!visible && this.container){\r\n      let body = document.body;\r\n      body.removeChild(this.container);\r\n      this.container=null;\r\n    }else if(visible && !this.container){\r\n      let body = document.body;\r\n      let container = document.createElement(\"div\");\r\n      container.classList.add('dialog-container');\r\n      if(this.props.modalClass){\r\n        container.classList.add(this.props.modalClass);\r\n      }\r\n      this.container=container;\r\n      body.appendChild(container);\r\n    }\r\n    //更新对话框里的内容\r\n    if(!visible){\r\n      return;\r\n    }\r\n    let classList=[\r\n      'dialog-body'\r\n    ];\r\n    if(this.props.customClass){\r\n      classList.push(this.props.customClass);\r\n    }\r\n    ReactDOM.render(\r\n      <div className={classList.join(' ')}>{this.props.children}</div>,\r\n      this.container\r\n    );\r\n  }\r\n  render(){\r\n    return null;\r\n  }\r\n}","import {Component} from 'react';\r\nimport Dialog from './dialog';\r\nimport { Translation } from 'react-i18next';\r\n\r\nconst MIN_WIDTH=4;\r\nconst MAX_WIDTH=30;\r\nconst MIN_HEIGHT=4;\r\nconst MAX_HEIGHT=24;\r\n\r\nfunction limitValue(value,min,max){\r\n  if(value<min){\r\n    return min;\r\n  }else if (value>max){\r\n    return max;\r\n  }\r\n  return value;\r\n}\r\nexport default class SettingDialog extends Component{\r\n  state={\r\n    display:false,\r\n    width:30,\r\n    height:16,\r\n    mines:99,\r\n    errorMsg:null\r\n  }\r\n  resolve=null;\r\n  reject=null;\r\n  constructor(){\r\n    super();\r\n  }\r\n  open(param){\r\n    return new Promise((resolve,reject)=>{\r\n      Object.assign(this,{\r\n        resolve,\r\n        reject\r\n      });\r\n      this.setState({\r\n        ...param,\r\n        errorMsg:null,\r\n        display:true\r\n      });\r\n    })\r\n  }\r\n  handleInputChange=(e)=>{\r\n    const target = e.target;\r\n    let value=target.value;\r\n    if(/^\\d+$/.test(value)){\r\n      value=Number(value);\r\n      switch(target.name){\r\n        case 'width':\r\n          value=limitValue(value,MIN_WIDTH,MAX_WIDTH);\r\n        break;\r\n        case 'height':\r\n          value=limitValue(value,MIN_HEIGHT,MAX_HEIGHT);\r\n        break;\r\n        case 'mines':\r\n          value=limitValue(value,4,MAX_WIDTH*MAX_HEIGHT-1);\r\n        break;\r\n      }\r\n    }\r\n    this.setState({\r\n      [target.name]: value\r\n    });\r\n  }\r\n  setLevel=(level)=>{\r\n    switch(level){\r\n      case 'beginner':\r\n        this.setState({\r\n          width:10,\r\n          height:10,\r\n          mines:10\r\n        });\r\n      break;\r\n      case 'medium':\r\n        this.setState({\r\n          width:16,\r\n          height:16,\r\n          mines:40\r\n        });\r\n      break;\r\n      case 'expert':\r\n        this.setState({\r\n          width:30,\r\n          height:16,\r\n          mines:99\r\n        });\r\n      break;\r\n    }\r\n    this.setState({\r\n      errorMsg:null\r\n    });\r\n  }\r\n  startGame=()=>{\r\n    let {width,height,mines}=this.state;\r\n    let errorList=[];\r\n    if(!/^\\d+$/.test(width)){\r\n      errorList.push('error_width');\r\n    }\r\n    if(!/^\\d+$/.test(height)){\r\n      errorList.push('error_height');\r\n    }\r\n    if(!/^\\d+$/.test(mines)){\r\n      errorList.push('error_mines');\r\n    }\r\n    if(errorList.length){\r\n      this.setState({\r\n        errorMsg:errorList\r\n      });\r\n      return;\r\n    }\r\n    width=Number(width);\r\n    height=Number(height);\r\n    mines=Number(mines);\r\n    let maxMines=width*height-1;\r\n    if(mines>maxMines){\r\n      mines=maxMines;\r\n    }\r\n    \r\n    if(this.resolve){\r\n      this.resolve({\r\n        width,\r\n        height,\r\n        mines\r\n      });\r\n    }\r\n    this.resolve=this.reject=null;\r\n    this.setState({\r\n      width,\r\n      height,\r\n      mines,\r\n      display:false\r\n    });\r\n  }\r\n  cancelSubmit=()=>{\r\n    if(this.reject){\r\n      this.reject('cancel');\r\n    }\r\n    this.resolve=this.reject=null;\r\n    this.setState({\r\n      display:false,\r\n      errorMsg:null\r\n    });\r\n  }\r\n  render(){\r\n    let errorMsg=this.state.errorMsg;\r\n    return (\r\n      <Translation>{t=>(\r\n        <Dialog visible={this.state.display} customClass='settingDialog'>\r\n          <div className='levelSelection'>\r\n            <span className='selectLevel' onClick={e=>this.setLevel('beginner')}>{t('Beginner')}</span>\r\n            <span className='selectLevel' onClick={e=>this.setLevel('medium')}>{t('Middle')}</span>\r\n            <span className='selectLevel' onClick={e=>this.setLevel('expert')}>{t('Expert')}</span>\r\n          </div>\r\n          <table className='gameSettingForm'>\r\n            <colgroup>\r\n              <col className='columnTitle'/>\r\n              <col className='columnInput'/>\r\n            </colgroup>\r\n            <tbody>\r\n              <tr className='formItem'>\r\n                <td className='itemTitle'>{t('Width')} ({MIN_WIDTH}-{MAX_WIDTH})</td>\r\n                <td>\r\n                  <input name='width' autoComplete=\"off\" maxLength='2' value={this.state.width} onInput={this.handleInputChange}/>\r\n                </td>\r\n              </tr>\r\n              <tr className='formItem'>\r\n                <td className='itemTitle'>{t('Height')} ({MIN_HEIGHT}-{MAX_HEIGHT})</td>\r\n                <td>\r\n                  <input name='height' autoComplete=\"off\" maxLength='2' value={this.state.height} onInput={this.handleInputChange}/>\r\n                </td>\r\n              </tr>\r\n              <tr className='formItem'>\r\n                <td className='itemTitle'>{t('Mines Count')} (2-{MAX_WIDTH*MAX_HEIGHT-1})</td>\r\n                <td>\r\n                  <input name='mines' autoComplete=\"off\" maxLength='3' value={this.state.mines} onInput={this.handleInputChange}/>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          {errorMsg && <div className='errorMsg'>{errorMsg.map(t).join('\\n')}</div>}\r\n          <div className='footer'>\r\n            <button className='startGame' onClick={this.startGame}><span>{t('OK')}</span></button>\r\n            <button className='cancelSetting' onClick={this.cancelSubmit}><span>{t('Cancel')}</span></button>\r\n          </div>\r\n        </Dialog>\r\n      )}</Translation>\r\n    );\r\n  }\r\n}\r\n","import {Component, createRef} from 'react';\r\nimport Cell from './cell';\r\nimport {writeLog} from './logManager';\r\nimport SettingDialog from './settingDialog.js';\r\nimport { Translation } from 'react-i18next';\r\n\r\nexport const VALUE_MINE=9;\r\nexport default class GamePage extends Component{\r\n  state={\r\n    width:null,\r\n    height:null,\r\n    mines:null,\r\n    board:[],\r\n    operation:[],\r\n    status:'initial'\r\n  };\r\n  $refs={\r\n    settingDialog:createRef()\r\n  }\r\n  constructor(){\r\n      super();\r\n  }\r\n  openSetting=async()=>{\r\n    try{\r\n      let data = await this.$refs.settingDialog.current.open({\r\n        width:this.state.width,\r\n        height:this.state.height,\r\n        mines:this.state.mines\r\n      });\r\n      await this.setState(data);\r\n      this.startGame();\r\n      localStorage.setItem('react-minesweeper-settings',JSON.stringify(data));\r\n    }catch(e){\r\n      if('cancel'!==e){\r\n        console.error(e);\r\n      }\r\n    }\r\n  }\r\n  startGame=()=>{\r\n    let board=[], width=this.state.width, height=this.state.height;\r\n    for(let row=0;row<height;row++){\r\n        let array=[];\r\n        for(let col=0;col<width;col++){\r\n            array.push({\r\n                key:Math.random(),\r\n                row,\r\n                col,\r\n                value:0\r\n            });\r\n        }\r\n        board.push({\r\n            key:Math.random(),\r\n            data:array\r\n        });\r\n    }\r\n    this.setState({\r\n      board,\r\n      operation:[],\r\n      status:'initial'\r\n    });\r\n  }\r\n  getNeighbours(rows,cols,row0,col0){\r\n    let result=[];\r\n    for(let row=row0-1; row<=row0+1; row++){\r\n      for(let col=col0-1; col<=col0+1; col++){\r\n        if(row<0 || row>=rows || col<0 || col>=cols || (row===row0 && col===col0)){\r\n          continue;\r\n        }\r\n        result.push({\r\n          row,col\r\n        });\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  getNeighbourMineCount(target,row0,col0){\r\n      let rows=target.length, cols=target[0].data.length, count=0,row,col;\r\n      for({row,col} of this.getNeighbours(rows,cols,row0,col0)){\r\n          let cell=target[row].data[col];\r\n          if(VALUE_MINE===(cell.value&0xf)){\r\n              count++;\r\n          }\r\n      }\r\n      return count;\r\n  }\r\n  initMines(target,mineCount,y,x){\r\n      let rows=target.length, cols=target[0].data.length;\r\n      if(mineCount >= rows*cols){\r\n        throw new RangeError('Too many mines');\r\n      }\r\n\r\n      let cellList=[];\r\n      for(let row=0; row<rows; row++){\r\n        for(let col=0; col<cols; col++){\r\n          //跳过被点击的位置\r\n          if(y===row && x===col){\r\n            continue;\r\n          }\r\n\r\n          cellList.push({\r\n            row,col\r\n          });\r\n        }\r\n      }\r\n\r\n      //对坐标列表进行洗牌\r\n      let length=cellList.length;\r\n      for(let i=0; i<length; i++){\r\n        if(Math.random()>0.5){\r\n          continue;\r\n        }\r\n        let j=Math.floor(Math.random()*(length-i-1))+i+1;\r\n        if(cellList[j]){\r\n          let temp=cellList[i];\r\n          cellList[i]=cellList[j];\r\n          cellList[j]=temp;\r\n        }\r\n      }\r\n\r\n      //布雷\r\n      for(let i=0; i<mineCount && cellList.length; i++){\r\n        let iCell=Math.floor(Math.random()*(cellList.length-1));\r\n        try{\r\n          let {row,col}=cellList[iCell];\r\n          target[row].data[col].value=VALUE_MINE;\r\n          cellList.splice(iCell,1);\r\n        }catch(e){\r\n          console.error(iCell,cellList.length,cellList[iCell]);\r\n        }\r\n      }\r\n\r\n      //标上数字\r\n      for(let row=0; row<rows; row++){\r\n        for(let col=0; col<cols; col++){\r\n          let cell=target[row].data[col];\r\n          if(VALUE_MINE===cell.value){\r\n              continue;\r\n          }\r\n          cell.value=this.getNeighbourMineCount(target,row,col);\r\n        }\r\n      }\r\n  }\r\n  dig(target,row0,col0){\r\n      let cell=target[row0].data[col0], counter=cell.value&0x0f;\r\n\r\n      //不可挖开的方块\r\n      if(cell.value&0xc0){\r\n        return 0;\r\n      }\r\n\r\n      //挖开该方块\r\n      target[row0].data[col0].value |= 0x80;\r\n\r\n      //挖到雷\r\n      if(VALUE_MINE===counter){\r\n        return -1;\r\n      }\r\n\r\n      return 1;\r\n  }\r\n  mark(target,row,col){\r\n      target[row].data[col].value |= 0x40;\r\n  }\r\n  autoproc(target){\r\n    let rows=target.length, cols=target[0].data.length;\r\n    let further=false;\r\n\r\n    //找到空方块，然后挖开周围方块；找到周边未挖开块数等于当前块雷数的块，然后把周围块标上\r\n    for(let row=0; row<rows; row++){\r\n      for(let col=0; col<cols; col++){\r\n        let cell=target[row].data[col], counter=cell.value&0x0f;\r\n        if(VALUE_MINE===counter || !(0xC0 & cell.value)){\r\n          continue;\r\n        }\r\n        let neighbours=this.getNeighbours(rows,cols,row,col).filter(({row,col})=>{\r\n            let cell=target[row].data[col];\r\n            return !(0x80&cell.value);\r\n        });\r\n        if(0===counter){\r\n          neighbours.forEach(({row,col})=>{\r\n              if(this.dig(target,row,col)){\r\n                  further=true;\r\n              }\r\n          });\r\n        }else if(neighbours.length === counter){\r\n          neighbours.forEach(({row,col})=>{\r\n              this.mark(target,row,col);\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    //找到周边被标记块数等于当前块雷数的块，然后把周围未标记且未挖开的块挖开\r\n    for(let row=0; row<rows; row++){\r\n      for(let col=0; col<cols; col++){\r\n        let cell=target[row].data[col], counter=cell.value&0x0f;\r\n        if(VALUE_MINE===counter || !(0xC0 & cell.value) || 0===counter){\r\n          continue;\r\n        }\r\n\r\n        //当前块周围被标记的块的个数\r\n        let neighbours=this.getNeighbours(rows,cols,row,col), markCount=0;\r\n        neighbours.forEach(({row,col})=>{\r\n          let cell=target[row].data[col];\r\n          if(0x40&cell.value){\r\n            markCount++;\r\n          }\r\n        });\r\n\r\n        //当前块周围被标记的块的个数不等于当前块的雷数\r\n        if(counter!==markCount){\r\n          continue;\r\n        }\r\n\r\n        //当前块周围未挖开且未标记的块挖开\r\n        neighbours.forEach(({row,col})=>{\r\n          let cell=target[row].data[col];\r\n          if(!(0xC0&cell.value)){\r\n            further=true;\r\n            this.dig(target,row,col);\r\n          }\r\n        });\r\n\r\n        //挖到雷了\r\n        if('failed'===this.status){\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n\r\n    return further;\r\n  }\r\n  gameFinished(target){\r\n    let rows=target.length, cols=target[0].data.length;\r\n    for(let row=0; row<rows; row++){\r\n      for(let col=0; col<cols; col++){\r\n        let cell=target[row].data[col], counter=cell.value&0x0f;\r\n        if(VALUE_MINE!==counter && !(0x80&cell.value)){\r\n            return false;\r\n        }\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n  handleDig=(data)=>{\r\n    let state=this.state;\r\n    let board=state.board.map(row=>({\r\n        ...row,\r\n        data:row.data.map(cell=>({\r\n            ...cell\r\n        }))\r\n    })), status=state.status;\r\n    //游戏结束了\r\n    if('failed'===status || 'success'===status){\r\n        return;\r\n    }\r\n\r\n    //刚开始挖时布雷\r\n    if('initial'===status){\r\n        this.initMines(board,state.mines,data.row,data.col);\r\n        status='running';\r\n    }\r\n\r\n    //挖开方块\r\n    let ret = this.dig(board,data.row,data.col);\r\n    if(-1===ret){\r\n        status='failed';\r\n    }\r\n\r\n    //处理更多雷\r\n    while('running'===status && this.autoproc(board)){}\r\n\r\n    //当前局面是否完成\r\n    if('running'===status && this.gameFinished(board)){\r\n      //完成时把没标上的地雷标上\r\n      for(let row of board){\r\n        row.data.forEach((cell,col)=>{\r\n          let counter=cell.value&0x0f;\r\n          if(VALUE_MINE===counter){\r\n            row.data[col].value|=0x40;\r\n          }\r\n        });\r\n      }\r\n      status='success';\r\n    }\r\n\r\n    //新加一步\r\n    let operation=[ //记录操作\r\n      ...state.operation,\r\n      {\r\n        time:new Date().getTime(),\r\n        col:data.col,\r\n        row:data.row\r\n      }\r\n    ];\r\n\r\n    //成功或失败时记录当前局面\r\n    if('failed'===status || 'success'===status){\r\n      writeLog(board,operation,'success'===status);\r\n    }\r\n    \r\n    this.setState({\r\n      ...state,\r\n      operation,\r\n      status,\r\n      board\r\n    });\r\n  }\r\n  async componentDidMount() {\r\n    //从localStorage获取设置，没获取到就用默认值\r\n    await this.setState({\r\n      width:30,\r\n      height:16,\r\n      mines:99\r\n    });\r\n    try{\r\n      let settingData=localStorage.getItem('react-minesweeper-settings');\r\n      if(settingData){\r\n        settingData=JSON.parse(settingData);\r\n        await this.setState({\r\n          width:Number(settingData.width),\r\n          height:Number(settingData.height),\r\n          mines:Number(settingData.mines)\r\n        });\r\n      }\r\n    }catch(e){\r\n      console.error(e);\r\n    }\r\n    this.startGame();\r\n  }\r\n  openDataAnalysis=()=>{\r\n    window.open('#/dataAnalysis');\r\n  }\r\n  render(){\r\n    let status=this.state.status;\r\n    let statusClass=status, statusMsg='';\r\n    switch(status){\r\n      case 'success':\r\n        statusMsg='Succeed';\r\n      break;\r\n      case 'failed':\r\n        statusMsg='Failed';\r\n      break;\r\n    }\r\n    let remainMines=this.state.mines;\r\n    for(let row of this.state.board){\r\n      for(let cell of row.data){\r\n        if(0x40&cell.value){\r\n          remainMines--;\r\n        }\r\n      }\r\n    }\r\n    return (\r\n      <Translation>{t=>(\r\n        <div className=\"gamePage\">\r\n          <div className=\"titleBar\">\r\n            <div className='btnGroup'>\r\n              <span className='newGame btn-link' onClick={this.startGame}>{t('New Game')}</span>\r\n              <span className='back btn-link' onClick={this.openSetting}>{t('Settings')}</span>\r\n              <span className='newGame btn-link' onClick={this.openDataAnalysis}>{t('Data Analysis')}</span>\r\n            </div>\r\n            <div className='statusGroup'>\r\n              <span className='steps'>{t('Steps')}{this.state.operation.length}</span>\r\n              <span className='remainMines'>{t('Remain')}{remainMines}</span>\r\n            </div>\r\n          </div>\r\n          <div className={['statusLine', statusClass].join(' ')}>{statusMsg ? t(statusMsg) : null}</div>\r\n          <div className='gamePadOuter'>\r\n            <div className='gamePad'>\r\n              {\r\n                this.state.board.map(row=><div className='gamePadRow' key={row.key}>\r\n                  {\r\n                    row.data.map(cell=><Cell data={cell} key={cell.key} onDig={this.handleDig} status={this.state.status}></Cell>)\r\n                  }\r\n                </div>)\r\n              }\r\n            </div>\r\n          </div>\r\n          <SettingDialog ref={this.$refs.settingDialog}></SettingDialog>\r\n        </div>\r\n      )}</Translation>\r\n    );\r\n  }\r\n}\r\n","import {Component} from 'react';\r\nimport { Translation } from 'react-i18next';\r\nimport {readLog, clearLog} from './logManager';\r\nimport {saveAs} from 'file-saver';\r\nimport Dialog from './dialog';\r\nimport './dataAnalysis.scss';\r\nimport dbf from 'dbf';\r\nexport default class DataAnalysis extends Component{\r\n    state={\r\n        confirmDeleteDialog:false,\r\n        dataRaw:null,\r\n        dataList:[]\r\n    };\r\n    componentWillMount(){\r\n        this.loadLogData();\r\n    }\r\n    loadLogData(){\r\n        let dataRaw = readLog();\r\n        let listLow = dataRaw.filter(item=>(10===item.width && 10===item.height && 10===item.mines.length));\r\n        let listMid = dataRaw.filter(item=>(16===item.width && 16===item.height && 40===item.mines.length));\r\n        let listHigh = dataRaw.filter(item=>(\r\n            ((30===item.width && 16===item.height) || (16===item.width && 30===item.height))\r\n            && 99===item.mines.length));\r\n        this.setState({\r\n            dataRaw,\r\n            dataList:[\r\n                {\r\n                    label:'Beginner',\r\n                    ...this.getStatResult(listLow)\r\n                },\r\n                {\r\n                    label:'Middle',\r\n                    ...this.getStatResult(listMid)\r\n                },\r\n                {\r\n                    label:'Expert',\r\n                    ...this.getStatResult(listHigh)\r\n                }\r\n            ]\r\n        });\r\n    }\r\n    getStatResult(data){\r\n        let success_times=0, one_click_finish=0, total_steps=0, time_total=0;\r\n        for(let item of data){\r\n            if(item.success){\r\n                success_times++;\r\n            }\r\n            if(1===item.operation.length){\r\n                one_click_finish++;\r\n            }\r\n            total_steps+=item.operation.length;\r\n            let time=item.operation[item.operation.length-1].time-item.operation[0].time;\r\n            time_total+=time;\r\n        }\r\n        return{\r\n            success_rate: data.length ? success_times/data.length : 0,\r\n            one_click_finish,\r\n            average_steps: data.length ? total_steps/data.length : 0,\r\n            average_time: data.length ? time_total/data.length : 0,\r\n        }\r\n    }\r\n    exportJSON=()=>{\r\n        saveAs(new Blob([JSON.stringify(this.state.dataRaw)], {type: \"text/plain;charset=utf-8\"}),'minesweeper-log.json');\r\n    }\r\n    exportDBF=()=>{\r\n        let dbfData=[];\r\n        for(let item of this.state.dataRaw){\r\n            dbfData.push({\r\n                WIDTH:item.width,\r\n                HEIGHT:item.height,\r\n                MINES:item.mines.length,\r\n                SUCCESS:item.success ? 1 : 0,\r\n                STEPS:item.operation.length,\r\n                START:item.operation[0].time,\r\n                TIME:(item.operation[item.operation.length-1].time-item.operation[0].time)\r\n            });\r\n        }\r\n        saveAs(new Blob([dbf.structure(dbfData).buffer]),'mine.dbf');\r\n    }\r\n    clearData=()=>{\r\n        this.setState({\r\n            confirmDeleteDialog:true\r\n        });\r\n    }\r\n    cancelDelete=()=>{\r\n        this.setState({\r\n            confirmDeleteDialog:false\r\n        });\r\n    }\r\n    confirmDelete=()=>{\r\n        this.setState({\r\n            confirmDeleteDialog:false\r\n        });\r\n        clearLog();\r\n        this.loadLogData();\r\n    }\r\n    goBack=()=>{\r\n        window.close();\r\n        window.location='#/';\r\n    }\r\n    render(){\r\n        return <Translation>{t=>(\r\n            <div className='dataAnalysis'>\r\n                <div className='toolbox'>\r\n                    <span className='btn-link' onClick={this.goBack}>{t('Close')}</span>\r\n                    <span className='btn-link' onClick={this.exportJSON}>{t('Export JSON')}</span>\r\n                    <span className='btn-link' onClick={this.exportDBF}>{t('Export DBF')}</span>\r\n                    <span className='btn-link' onClick={this.clearData}>{t('Clear Data')}</span>\r\n                </div>\r\n                <table className='mainTable'>\r\n                    <tbody>\r\n                        <tr>\r\n                            <th>{t('Level')}</th>\r\n                            <th>{t('Success Rate')}</th>\r\n                            <th>{t('Average Steps')}</th>\r\n                            <th>{t('Average Time')}</th>\r\n                            <th>{t('One-step Success Times')}</th>\r\n                        </tr>\r\n                        {\r\n                            this.state.dataList.map(item=>{\r\n                                return <tr key={item.label}>\r\n                                    <td>{t(item.label)}</td>\r\n                                    <td>{(item.success_rate*100).toFixed(2)}%</td>\r\n                                    <td>{(item.average_steps).toFixed(2)}</td>\r\n                                    <td>{(item.average_time/1000).toFixed(2)}s</td>\r\n                                    <td>{item.one_click_finish}</td>\r\n                                </tr>\r\n                            })\r\n                        }\r\n                    </tbody>\r\n                </table>\r\n                <Dialog visible={this.state.confirmDeleteDialog}  customClass='confirmDeleteDialog'>\r\n                    <div className='warningSign'>⚠</div>\r\n                    <div className='warningMessage'>{t('_confirmDeleteGameData')}</div>\r\n                    <button className='confirmDelete' onClick={this.confirmDelete}>{t('OK')}</button>\r\n                    <button className='cancelDelete' onClick={this.cancelDelete}>{t('Cancel')}</button>\r\n                </Dialog>\r\n            </div>\r\n        )}</Translation>\r\n    }\r\n}","export default{\r\n    'zh':{\r\n        translation:{\r\n            'Minesweeper':'扫雷',\r\n            'New Game':'新游戏',\r\n            'Data Analysis':'数据分析',\r\n            'Settings':'设置',\r\n            'Steps':'步数：',\r\n            'Remain':'剩余雷数：',\r\n            'Failed':'失败了',\r\n            'Succeed':'成功了',\r\n            'Beginner':'初级',\r\n            'Middle':'中级',\r\n            'Expert':'高级',\r\n            'Width':'宽度',\r\n            'Height':'高度',\r\n            'Mines Count':'雷数',\r\n            'OK':'确定',\r\n            'Cancel':'取消',\r\n            'error_width':'宽度值必须为整数',\r\n            'error_height':'高度值必须为整数',\r\n            'error_mines':'雷数必须为整数',\r\n            'Back':'返回',\r\n            'Close':'关闭',\r\n            'Export JSON':'导出JSON数据',\r\n            'Export DBF':'导出DBF数据',\r\n            'Level':'级别',\r\n            'Success Rate':'成功率',\r\n            'Average Steps':'平均步数',\r\n            'Average Time':'平均用时',\r\n            'One-step Success Times':'一步成功次数',\r\n            'Clear Data':'清除数据',\r\n            '_confirmDeleteGameData':'本操作将删除所有的游戏记录！\\n是否继续？'\r\n        }\r\n    },\r\n    'en':{\r\n        translation:{\r\n            'Minesweeper':'Minesweeper',\r\n            'New Game':'New Game',\r\n            'Data Analysis':'Data Analysis',\r\n            'Settings':'Settings',\r\n            'Steps':'Steps: ',\r\n            'Remain':'Remain: ',\r\n            'Failed':'Failed',\r\n            'Succeed':'Succeed',\r\n            'Beginner':'Beginner',\r\n            'Middle':'Middle',\r\n            'Expert':'Expert',\r\n            'Width':'Width',\r\n            'Height':'Height',\r\n            'Mines Count':'Mines',\r\n            'OK':'OK',\r\n            'Cancel':'Cancel',\r\n            'error_width':'Width must be integer',\r\n            'error_height':'Height must be integer',\r\n            'error_mines':'Mines must be integer',\r\n            'Back':'Back',\r\n            'Close':'Close',\r\n            'Export JSON':'Export As JSON',\r\n            'Export DBF':'Export As DBF',\r\n            'Level':'Level',\r\n            'Success Rate':'Success Rate',\r\n            'Average Steps':'Avg. Steps',\r\n            'Average Time':'Avg. Time',\r\n            'Average Time':'Avg. Time',\r\n            'One-step Success Times':'One-step Success Times',\r\n            'Clear Data':'Clear Data',\r\n            '_confirmDeleteGameData':'This option will delete ALL the game records!\\nContinue?'\r\n        }\r\n    },\r\n    'ja':{\r\n        translation:{\r\n            'Minesweeper':'マインスイーパ',\r\n            'New Game':'スタート',\r\n            'Data Analysis':'データ解析',\r\n            'Settings':'設定',\r\n            'Steps':'操作回数：',\r\n            'Remain':'残り地雷：',\r\n            'Failed':'失敗しました',\r\n            'Succeed':'成功しました',\r\n            'Beginner':'初級',\r\n            'Middle':'中級',\r\n            'Expert':'上級',\r\n            'Width':'幅',\r\n            'Height':'高さ',\r\n            'Mines Count':'地雷の数',\r\n            'OK':'OK',\r\n            'Cancel':'キャンセル',\r\n            'error_width':'幅は整数でなければなりません',\r\n            'error_height':'高さは整数でなければなりません',\r\n            'error_mines':'地雷の数は整数でなければなりません',\r\n            'Back':'戻る',\r\n            'Close':'閉じる',\r\n            'Export JSON':'JSONをエクスポート',\r\n            'Export DBF':'DBFをエクスポート',\r\n            'Level':'レベル',\r\n            'Success Rate':'成功率',\r\n            'Average Steps':'平均操作回数',\r\n            'Average Time':'平均時間',\r\n            'One-step Success Times':'一回の操作で成功できるの回数',\r\n            'Clear Data':'データを削除',\r\n            '_confirmDeleteGameData':'この操作はすべてのゲーム履歴を削除します。\\n続けますか？'\r\n        }\r\n    }\r\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './style.scss';\nimport GamePage from './game';\nimport DataAnalysis from './dataAnalysis';\nimport { HashRouter, Route, Redirect } from 'react-router-dom';\n//import reportWebVitals from './reportWebVitals';\n\n//多语言准备\nimport i18n from 'i18next';\nimport resources from './langpack';\nimport { initReactI18next } from 'react-i18next';\nimport LanguageDetector from 'i18next-browser-languagedetector';\n\ni18n.use(initReactI18next).use(LanguageDetector).init({\n  resources,\n  fallbackLng: 'en',\n  keySeparator: false, // we do not use keys in form messages.welcome\n  interpolation: {\n    escapeValue: false, // react already safes from xss\n  },\n  detection:{\n    order: ['querystring','navigator'],\n    lookupQuerystring: 'language',\n    caches:[]\n  }\n}).then(t=>{\n  document.title=t('Minesweeper');\n});\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter>\n      <Route path=\"/\" exact component={GamePage}></Route>\n      <Route path=\"/dataAnalysis\" exact component={DataAnalysis}></Route>\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n//reportWebVitals();\n"],"sourceRoot":""}